function toggle_persist_groups(persist_groups) {
  if(persist_groups) {
    $('persist_groups_assignment').enable();
    $('persist_groups_assignment_style').removeClassName('disable');
    $('persist_groups_assignment').onchange();
    $('is_group_assignment').disable();
    $('is_group_assignment').addClassName('disable');
    $('students_form_groups').disable();
    $('students_form_groups_style').addClassName('disable');
    $('assignment_group_min').disable();
    $('assignment_group_max').disable();
    $('group_limit_style').addClassName('disable')
    $('assignment_group_name_autogenerated').disable();    
  } else {
    $('persist_groups_assignment').disable();
    $('persist_groups_assignment_style').addClassName('disable');
    $('is_group_assignment').enable();
    $('is_group_assignment').removeClassName('disable');
    toggle_group_assignment($F('is_group_assignment'));
  }
}

function toggle_group_assignment(is_group_assignment) {
  if(is_group_assignment) {
    $('students_form_groups').enable();
    $('students_form_groups_style').removeClassName('disable');
    $('persist_groups').enable();
    $('persist_groups_assignment_style').removeClassName('disable');
    toggle_students_form_groups($F('students_form_groups'));
  } else {
    $('assignment_group_min').disable();
    $('assignment_group_max').disable();
    $('group_limit_style').addClassName('disable');
    $('students_form_groups').disable();
    $('students_form_groups_style').addClassName('disable');
    $('assignment_group_name_autogenerated').disable();
    $('group_name_autogenerated_style').addClassName('disable');
    $('persist_groups').disable();
    $('persist_groups_assignment_style').addClassName('disable');
  }
}

function toggle_students_form_groups(students_form_groups) {
  if(students_form_groups) {
    $('assignment_group_min').enable();
    $('assignment_group_max').enable();
    $('group_limit_style').removeClassName('disable');
    $('assignment_group_name_autogenerated').setValue(true);
    $('assignment_group_name_autogenerated').disable();
    $('group_name_autogenerated_style').addClassName('disable');
  } else {
    $('assignment_group_min').disable();
    $('assignment_group_max').disable();
    $('group_limit_style').addClassName('disable');
    $('assignment_group_name_autogenerated').enable();  
    $('group_name_autogenerated_style').removeClassName('disable');
  }
}

function request_group_properties(assignment_id) {
/*  new Ajax.Request('update_group_properties_on_dependency', {asynchronous:true, evalScripts:true, parameters:'assignment_id=' + $F('assignment_dependency_list')}*/
}

function update_group_properties(is_group_assignment, students_form_groups, group_min, group_max, group_name_autogenerated) {
 $('is_group_assignment').setValue(is_group_assignment);
 $('students_form_groups').setValue(students_form_groups);
 $('assignment_group_min').setValue(group_min);
 $('assignment_group_max').setValue(group_max);
 $('assignment_group_name_autogenerated').setValue(group_name_autogenerated);
 
 $('is_group_assignment').disable();
 $('is_group_assignment').addClassName('disable');
 $('students_form_groups').disable();
 $('students_form_groups_style').addClassName('disable');
 $('assignment_group_min').disable();
 $('assignment_group_max').disable();
 $('group_limit_style').addClassName('disable');
 $('assignment_group_name_autogenerated').disable();
 $('group_name_autogenerated_style').addClassName('disable');

}

function add_assignment_file() {
  var new_assignment_file_div = new Element('div', {'class': 'assignment_file'})
  var new_assignment_file = new Element('input', {'type': 'text', 'name': 'assignment_files[]'})
  new_assignment_file.observe('keydown', function(e) {
    if(e.keyCode == Event.KEY_RETURN) {
      e.stop();
    }
  });
  var remove_link = new Element('a', {'href': 'javascript:void(0);'})
  remove_link.update('x')
  remove_link.observe('click', function(e) {
    $(new_assignment_file_div).remove();
  });
  new_assignment_file_div.insert(new_assignment_file);
  new_assignment_file.insert({'after': remove_link});
  $('assignment_files').insert(new_assignment_file_div);
  $(new_assignment_file).activate();
}
