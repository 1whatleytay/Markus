<%= javascript_include_tag "submissions_manager" %>
<%= javascript_include_tag "FilterTable/FilterTable.js" %>
<%= render :partial => 'submissions_table_boot.js.erb', :locals => {:details => @details, :assignment => @assignment} %>


<div id="title_bar">
  <h1>Workspace: <%= h(sanitize(@assignment.short_identifier)) %></h1>
  <% if Time.now >= @assignment.submission_rule.calculate_collection_time %>
  <h2>Grading can begin</h2>
  <% else %>
  <h2>Grading can begin after <%= h(@assignment.submission_rule.calculate_collection_time.strftime(LONG_DATE_TIME_FORMAT))%> </h2>
  <% end %>
</div>

<div class="wrapLeft">
  <%= link_to "Go to Normal View", :action => 'browse', :id => @assignment.id %>
  <%= link_to "Go to Detailed View", :action => 'browse', :id => @assignment.id, :details => true %>
</div>

<div class="wrapLeft">
<% if flash[:release_errors] %>
<div class="error">
  <h1>Errors</h1>
  <ul>
  <% flash[:release_errors].each do |error_message| %>
    <li><%= error_message %></li>
  <% end %>
  </ul>
</div>
<% end %>

<%= form_tag({:action => 'update_submissions', :id => @assignment.id}) %>
<span id="loading_list"><%= image_tag("spinner.gif")%> Loading
list...</span>
<table id="submissions">

</table>
<% if @current_user.admin? %>
<%= submit_tag "Release Marks", :name => "release_results" %>
<%= submit_tag "Unrelease Marks", :name => "unrelease_results" %>
<% end %>
</form>

<p>
<%= link_to "Download Simple CSV Report File", :action => 'download_simple_csv_report', :id => @assignment.id %>
</p>
<p>
<%= link_to "Download Detailed CSV Report File", :action => 'download_detailed_csv_report', :id => @assignment.id %>
</p>
<p>
<%= link_to "Download Subversion Export Batch File", :action => 'download_svn_export_commands', :id => @assignment.id %>
</p>
</div>
