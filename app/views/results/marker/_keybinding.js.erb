$criteria_list = $('#mark_criteria_pane_list>li:not(.unassigned)');

Mousetrap.bind('shift+,', function(){
  $('#student_selector>.left>a')[0].click();
});
Mousetrap.bind('shift+.', function(){
  $('#student_selector>.right>a')[0].click();
});
$(document).on('focus', '.rubric_criterion, .flexible_criterion, .checkbox_criterion', function (e) {
  if(!$(this).hasClass('unassigned')){
      activeCriteria($(this));
  }
});
Mousetrap.bind('shift+tab', function(e){
    $criteria_list.first().focus();
    return false;
});
Mousetrap.bind('up', function(e){
  $current_criteria = $('.active-criteria');
  if($current_criteria.length && !$current_criteria.hasClass('unassigned')){
      if($current_criteria.hasClass('rubric_criterion')){
          e.preventDefault();
          $selected = $('.active-rubric');
          if($selected.length){
              $next = $selected.parent().prev();
              if(!$next.length){
                  $next = $selected.parent().siblings().last();
              }
              $selected.removeClass('active-rubric');
              $next.children().addClass('active-rubric');
          }
          return false;
      }
  }
});
Mousetrap.bind('down', function(e){
    $current_criteria = $('.active-criteria');
    if($current_criteria.length && !$current_criteria.hasClass('unassigned')){
        if($current_criteria.hasClass('rubric_criterion')){
            e.preventDefault();
            $selected = $('.active-rubric');
            if($selected.length){
                $next = $selected.parent().next();
                if(!$next.length){
                    $next = $selected.parent().siblings().first();
                }
                $selected.removeClass('active-rubric');
                $next.children().addClass('active-rubric');
            }
            return false;
        }
    }
});
Mousetrap.bind('enter', function (e) {
    if($('.active-rubric').length){
        e.preventDefault();
        $('.active-rubric').trigger('onclick');
//        $('.active-criteria').find('.criterion_title').trigger('click');
    }
})
